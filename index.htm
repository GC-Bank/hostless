<!DOCTYPE html>
<head><title>%title%</title>
<meta charset="utf-8"/>
</head>
<body>

This site is served to you in a hostless manner ...

<div id=page>searching ...<br>
This page is at %loc%
(please wait until we find its <a href="%url%">content</a>)</div>

<hr>
<a href=https://michel47.github.io/hostless/>source</a>
<script>
const version = 'master';
const GH = 'https://raw.githubusercontent.com/michel47/hostless/';
var url = document.location.href;
var host = document.location.host;
var domain = document.location.hostname;
var origin = document.location.origin;

var url = GH + version + '/web/' + domain + '/page.htm';
console.log('url ',url);
fetch(url)
.then(function(resp) {
      status = resp.status
      console.log('status: '+status);
      if (status = '200') {
      resp.text().then( (page) => update(page) );
      }
      })
.catch(function(error) { console.log('catch: '+error) })


function update() {
var loc = document.location.toString();
    loc = loc.replace(/#.*/,'');
var fragment = window.location.hash.substring(1);
var email = 'info@'+document.location.hostname;

//var body = document.getElementsByTagName('body')[0];
var page = document.getElementById('page');
var buf = page.innerHTML.replace(/%domain%/g,domain);

    buf = buf.replace(/%origin%/g,origin);
    buf = buf.replace('%host%',host);
    buf = buf.replace('%loc%',loc);
    buf = buf.replace('%fragment%',fragment);
    buf = buf.replace(/%email%/g,email);
    buf = buf.replace(/%url%/g,url);

    //console.log('buf: '+buf);
    page.innerHTML = buf;
}

</script>
</body>
